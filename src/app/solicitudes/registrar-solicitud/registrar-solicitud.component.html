<form (ngSubmit)="onSubmit()" #SolicitudForm="ngForm" #solicitudForm="ngForm">
	<div class="card">
		<div class="card-body text-start">
			<div class="header-solicitud">
				<div class="row">
					<div class="col-md-8">
						<div class="mb-3">
							<h3 class="sol-danger">
								<a routerLink="/tareas/consulta-tareas"> <i class="bi bi-arrow-left-circle azul"></i> {{ solicitud.idSolicitud }} </a>
							</h3>
						</div>
					</div>

					<div *ngIf="!existeMatenedores || existe" class="col-md-4 text-end d-flex justify-content-end align-items-center">
						<!-- <button *ngIf="existeMatenedores" type="button" (click)="openModal('dialogReasignarUsuario')" class="btn btn-info me-2 d-flex align-items-center justify-content-center button-custom"><i class="fas fa-save me-2 icon-size"></i> Reasignar</button> -->

						<button type="submit" class="btn btn-info me-2 d-flex align-items-center justify-content-center button-custom" aria-label="Close" [disabled]="!solicitudForm.form.valid || selectedOption === 'Si'"><i class="fas fa-save me-2 icon-size"></i> Guardar</button>

						<button *ngIf="RegistrarsolicitudCompletada || selectedOption === 'Si'" type="button" (click)="onCompletar()" class="btn btn-info me-2 d-flex align-items-center justify-content-center button-custom"><i class="fas fa-check-circle me-2 icon-size"></i> Enviar Solicitud</button>
					</div>
				</div>

				<div class="row mt-4">
					<div class="col-md-4">
						<div class="input-group mb-3">
							<label class="label-estilo">Creado por:</label>

							<span style="color: black; font-size: 14px" class="text-start">{{ solicitud.usuarioCreacion }}</span>
						</div>
					</div>

					<div class="col-md-4">
						<div class="input-group mb-3">
							<label class="label-estilo">Fecha:</label>

							<span style="color: black; font-size: 14px" class="text-start">{{ solicitud.fechaCreacion | date : "yyyy/MM/dd" }}</span>
						</div>
					</div>

					<div class="col-md-4">
						<div class="input-group mb-3">
							<label class="label-estilo">Nro. Solicitud:</label>

							<span style="color: black; font-size: 14px" class="text-start">{{ solicitud.idSolicitud }}</span>
						</div>
					</div>
				</div>

				<hr />
			</div>

			<div class="row after-header-solicitud">
				<div class="col-md-3">
					<div class="mb-4">
						<h3 class="sol-danger">Información general</h3>
					</div>
				</div>

				<div class="col-md-9">
					<hr />
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="tipoSolicitud">Tipo de solicitud</label>

						&nbsp;

						<span #mivar id="tipoSolicitud" name="idTipoSolicitud" style="color: black; font-size: 14px" class="text-start">{{ solicitud.tipoSolicitud }}</span>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="tipomotivo">Tipo de motivo</label>

						&nbsp;

						<span id="tipomotivo" name="tipomotivo" style="color: black; font-size: 14px" class="text-start">{{ solicitud.tipoMotivo }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group">
						<label class="input-group-text label-estilo" for="codigoposicion">Código de posición</label>

						&nbsp;

						<span *ngIf="solicitud.tipoMotivo === 'Reemplazo'; else editablePosition" id="descripcionposicion" name="descripcionposicion" style="color: black; font-size: 14px" class="text-start">{{ model.codigoPosicion }}</span>

						<ng-template #editablePosition>
							<input type="text" name="codigoposicion" [(ngModel)]="model.codigoPosicion" style="color: black; font-size: 14px; width: 30%" class="form-control" id="codigoposicion" aria-describedby="inputGroupPrepend" required #codigoposicion="ngModel" placeholder="Ingrese código" [ngbTypeahead]="searchDescripcionPosicion" [ngbTypeahead]="searchCodigoPosicion" (selectItem)="onSelectItem('codigoPosicion', $event)" />

							<button class="btn btn-light" type="button" (click)="getDataEmpleadosEvolution('codigoPosicion')">
								<i class="ti-search"></i>
							</button>
						</ng-template>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="descripcionposicion">Descripción de posición</label>

						&nbsp;

						<span *ngIf="solicitud.tipoMotivo === 'Reemplazo'; else editableDescPosition" id="descripcionposicion" name="descripcionposicion" style="color: black; font-size: 14px" class="text-start">{{ model.descrPosicion }}</span>

						<ng-template #editableDescPosition>
							<input type="text" name="descripcion-posicion" [(ngModel)]="model.descrPosicion" style="color: black; font-size: 14px; width: 30%" class="form-control text-start" id="descripcionPosicion" aria-describedby="inputGroupPrepend" required #descripcionPosicion="ngModel" placeholder="Ingrese descripcion posicion" [ngbTypeahead]="searchCodigoPosicion" [ngbTypeahead]="searchDescripcionPosicion" (selectItem)="onSelectItem('descrPosicion', $event)" />

							<button class="btn btn-light" type="button" (click)="getDataEmpleadosEvolution('descrPosicion')">
								<i class="ti-search"></i>
							</button>
						</ng-template>
					</div>
				</div>
			</div>

			<div class="row" *ngIf="mostrarSubledger">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="subledger">Subledger</label>

						&nbsp;

						<input type="text" name="subledger" [(ngModel)]="model.subledger" style="color: black; font-size: 14px; width: 30%" class="form-control text-start" id="subledger" aria-describedby="inputGroupPrepend" required #subledger="ngModel" placeholder="Ingrese subledger" [ngbTypeahead]="searchNombre" [ngbTypeahead]="searchSubledger" (selectItem)="onSelectItem('subledger', $event)" />

						<button class="btn btn-light" type="button" (click)="getDataEmpleadosEvolution('subledger')">
							<i class="ti-search"></i>
						</button>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="nombreempleado"> Empleado </label>

						&nbsp;

						<input type="text" name="nombreCompleto" [(ngModel)]="model.nombreCompleto" style="color: black; font-size: 14px; width: 30%" class="form-control text-start" id="nombreCompleto" [ngbTypeahead]="searchSubledger" [ngbTypeahead]="searchNombre" (selectItem)="onSelectItem('nombreCompleto', $event)" aria-describedby="inputGroupPrepend" #nombreCompleto="ngModel" placeholder="Ingrese nombre" required />

						<button class="btn btn-light" type="button" (click)="getDataEmpleadosEvolution('nombreCompleto')">
							<i class="ti-search"></i>
						</button>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="compania">Compañía</label>

						<span id="compania" name="" style="color: black; font-size: 14px" class="text-start">{{ model.compania }}</span>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="unidadnegocio">Unidad de negocio</label>

						<span id="unidadnegocio" name="" style="color: black; font-size: 14px" class="text-start">{{ model.unidadNegocio }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="departamento">Área/Departamento</label>

						<span id="departamento" name="" style="color: black; font-size: 14px" class="text-start">{{ model.departamento }}</span>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="tipocargo">Tipo de cargo</label>

						<span id="cargo" name="" style="color: black; font-size: 14px" class="text-start">{{ model.nombreCargo }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="localidadzona">Localidad/Zona</label>

						<span id="localidadzona" name="" style="color: black; font-size: 14px" class="text-start">{{ model.localidad }}</span>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="niveldirección">Nivel de dirección</label>

						<span id="niveldirección" name="" style="color: black; font-size: 14px" class="text-start">{{ model.nivelDir }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="centrocosto">Centro de costo</label>

						<span id="centrocosto" name="" style="color: black; font-size: 14px" class="text-start">{{ model.nomCCosto }}</span>
					</div>
				</div>

				<div class="col-md-6" *ngIf="mostrarTipoJustificacionYMision">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="misioncargo">Misión del cargo <span style="color: red">*</span></label>

						<input type="text" name="misioncargo" placeholder="Campo obligatorio" [(ngModel)]="model.misionCargo" class="form-control" id="misioncargo" #misioncargo="ngModel" required />
					</div>
				</div>
			</div>
			<div class="row" *ngIf="mostrarTipoJustificacionYMision">
				<div class="col">
					<div class="input-group mb-3 contenedor">
						<label class="input-group-text adjustable-label" for="justificacion">Justificación <span style="color: red">*</span></label>

						&nbsp;

						<textarea id="justificacion" name="justificacion" placeholder="Campo obligatorio" [(ngModel)]="model.justificacionCargo" style="color: black; font-size: 14px" required #justificacion="ngModel"></textarea>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-md-4">
					<div class="mb-4">
						<h3 class="sol-danger">Funciones y responsabilidades</h3>
					</div>
				</div>

				<div class="col-md-8">
					<hr />
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo2" for="reporta">Reporta a</label>

						&nbsp;

						<span id="reporta" name="" style="color: black; font-size: 14px" class="text-start">{{ model.reportaA }} </span>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="nivelRepa">Nivel de reporte</label>

						&nbsp;

						<span id="nivelRepa" name="" style="color: black; font-size: 14px" class="text-start">{{ model.nivelRepa }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="tipocontrato">Tipo de contrato</label>

						&nbsp;

						<select id="tipocontrato" name="tipocontrato" class="form-select" [(ngModel)]="model.tipoContrato" style="font-size: 14px" required>
							<option selected>Eventual</option>

							<option>Temporal</option>

							<option>Mixto</option>
						</select>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="supervisaa">Supervisa a</label>

						&nbsp;

						<span id="supervisaa" name="" style="color: black; font-size: 14px" class="text-start">{{ model.supervisaA }}</span>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="sueldo">Sueldo</label>

						&nbsp;

						<div class="d-flex gap-2 align-items-center">
							<span class="fs-6">$</span>

							<input [(ngModel)]="model.sueldo" type="text" mask="separator.2" [leadZero]="true" name="sueldo" class="form-control" id="sueldo" />
						</div>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-md-4">
					<div class="mb-4">
						<h3 class="sol-danger">Tipo de variable</h3>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="mensual">Mensual</label>

						<div class="d-flex gap-2 align-items-center">
							<span class="fs-6">$</span>

							<input [(ngModel)]="model.sueldoMensual" type="text" mask="separator.2" [leadZero]="true" name="mensual" class="form-control" id="mensual" />
						</div>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="trimestral">Trimestral</label>

						<div class="d-flex gap-2 align-items-center">
							<span class="fs-6">$</span>

							<input [(ngModel)]="model.sueldoTrimestral" type="text" mask="separator.2" [leadZero]="true" name="trimestral" class="form-control" id="trimestral" />
						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="semestral">Semestral</label>

						<div class="d-flex gap-2 align-items-center">
							<span class="fs-6">$</span>

							<input [(ngModel)]="model.sueldoSemestral" type="text" mask="separator.2" [leadZero]="true" name="semestral" class="form-control" id="semestral" />
						</div>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-group mb-3">
						<label class="input-group-text label-estilo" for="anual">Anual</label>

						<div class="d-flex gap-2 align-items-center">
							<span class="fs-6">$</span>

							<input [(ngModel)]="model.sueldoAnual" type="text" mask="separator.2" [leadZero]="true" name="anual" class="form-control" id="anual" />
						</div>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-md-4">
					<div class="mb-4">
						<h3 class="sol-danger">Aprobadores de la solicitud</h3>
					</div>
				</div>

				<div class="col-md-8">
					<hr />
				</div>
			</div>

			<div class="accordion" id="accordionExample">
				<div *ngFor="let nivelItem of dataAprobacionesPorPosicion[keySelected]; let i = index" class="accordion-item">
					<div class="accordion-header">
						<button class="accordion-button" type="button" data-bs-toggle="collapse" [attr.data-bs-target]="'#collapse' + i" aria-expanded="true" [attr.aria-controls]="'collapse' + i" style="display: block">
							<div class="row" style="align-items: center; justify-content: space-around">
								<div class="col">{{ nivelItem.nivelAprobacionType.ruta }}</div>

								<div class="col">
									{{ nivelItem.aprobador.usuario !== "" && nivelItem.aprobador.usuario !== undefined && nivelItem.aprobador.usuario != null ? nivelItem.aprobador.codigoPosicion + "-" + nivelItem.aprobador.usuario : "No aplica" }}
								</div>

								<div class="col">
									{{ nivelItem.nivelAprobacionType.nivelAprobacionRuta }}
								</div>
							</div>
						</button>
					</div>

					<div [id]="'collapse' + i" class="accordion-collapse collapse" [ngClass]="{ show: i === 0 }" data-bs-parent="#accordionExample">
						<div class="row">
							<div class="col">
								<div class="input-group">
									<label for="lvl1descripcion">Descripción de la posición</label>

									&nbsp;

									<span id="lvl1descripcion" name="" style="color: black; font-size: 14px">{{ nivelItem.aprobador.descripcionPosicion !== "" && nivelItem.aprobador.descripcionPosicion !== undefined && nivelItem.aprobador.descripcionPosicion != null ? nivelItem.aprobador.descripcionPosicion : "No aplica" }}</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-md-4">
					<div class="mb-4">
						<h3 class="sol-danger">Anulación de Solicitud</h3>
					</div>
				</div>

				<div class="col-md-8">
					<hr />
				</div>
			</div>

			<div class="row">
				<div class="col">
					<div class="input-group mb-3 contenedor">
						<label class="input-group-text adjustable-label" for="anular">¿Anular Solicitud?</label>

						&nbsp;

						<div class="form-check form-check-inline">
							<input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="Si" [(ngModel)]="selectedOption" (change)="onSelectionChange()" />

							<label class="form-check-label" for="inlineRadio1">Si</label>
						</div>

						<div class="form-check form-check-inline">
							<input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="No" [(ngModel)]="selectedOption" (change)="onSelectionChange()" />
							<label class="form-check-label" for="inlineRadio2">No</label>
						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col">
					<div class="input-group mb-3 contenedor">
						<label class="input-group-text adjustable-label adjustable-label" for="anulacion">Comentarios Anulación de Solicitud</label>

						&nbsp;

						<textarea id="anulacion" name="anulacion" [(ngModel)]="model.comentariosAnulacion" style="color: black; font-size: 14px"></textarea>
					</div>
				</div>
			</div>
		</div>
	</div>
</form>
